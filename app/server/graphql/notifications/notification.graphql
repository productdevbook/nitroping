enum NotificationStatus {
  PENDING
  SENT
  DELIVERED
  FAILED
  SCHEDULED
}

enum DeliveryStatus {
  PENDING
  SENT
  DELIVERED
  FAILED
  CLICKED
}

type Notification {
  id: ID!
  appId: ID!
  app: App
  title: String!
  body: String!
  data: JSON
  imageUrl: String
  clickAction: String
  sound: String
  badge: Int
  status: NotificationStatus!
  
  # Targeting
  targetDevices: JSON # Array of device IDs
  platforms: JSON # Array of platforms
  scheduledAt: Timestamp
  
  # Statistics
  totalTargets: Int!
  totalSent: Int!
  totalDelivered: Int!
  totalFailed: Int!
  totalOpened: Int!
  totalClicked: Int!
  
  # Relations
  deliveryLogs: [DeliveryLog!]
  
  # Timestamps
  createdAt: Timestamp!
  updatedAt: Timestamp!
  sentAt: Timestamp
}

type DeliveryLog {
  id: ID!
  notificationId: ID!
  notification: Notification
  deviceId: ID
  device: Device
  to: String
  status: DeliveryStatus!
  errorMessage: String
  sentAt: Timestamp
  openedAt: Timestamp
  clickedAt: Timestamp

  # Timestamps
  createdAt: Timestamp!
  updatedAt: Timestamp!
}

input SendNotificationInput {
  appId: ID!
  title: String!
  body: String!
  data: JSON
  imageUrl: String
  clickAction: String
  sound: String
  badge: Int

  # Push targeting
  targetDevices: JSON # Array of device IDs or tokens
  platforms: JSON # Array of platforms
  scheduledAt: Timestamp

  # Multi-channel targeting
  channelType: ChannelType         # EMAIL, SMS, DISCORD, IN_APP for channel-based delivery
  channelId: ID                    # Specific channel to use (optional, falls back to first active)
  contactIds: [ID!]                # Target specific contacts (if omitted, targets all app contacts)
}

extend type Query {
  notifications(appId: ID, limit: Int = 50, offset: Int = 0): [Notification!]!
  notification(id: ID!): Notification
  deliveryLogs(notificationId: ID, limit: Int = 50, offset: Int = 0): [DeliveryLog!]!
}

extend type Mutation {
  sendNotification(input: SendNotificationInput!): Notification!
  scheduleNotification(input: SendNotificationInput!): Notification!
  cancelNotification(id: ID!): Boolean!
}